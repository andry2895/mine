function start_local_datatables(){$(".datatables").each(function(){$.fn.DataTable.isDataTable($(this))||$(this).DataTable({language:globals.translations.datatables,retrieve:!0,ordering:!0,searching:!0,paging:!1,order:[],lengthChange:!1,scrollY:"70vh"})})}function start_datatables(){start_local_datatables(),$(".main-records").each(function(){var t=$(this);if(t.data("selected",""),!$.fn.DataTable.isDataTable("#"+t.attr("id"))){var e=t.data("idmodule"),a=t.data("idplugin"),o=t.data("idparent"),s=getTableSearch(),n=[];t.find("th").each(function(){var t=$(this).attr("id").replace("th_",""),e=s["search_"+t]?s["search_"+t]:"";n.push({sSearch:e})});var r,l=1e3*globals.tempo_attesa_ricerche;t.on("preInit.dt",function(t,e){$(t.target).hasClass("main-records")&&$("#mini-loader").show()});var d=t.DataTable({language:globals.translations.datatables,autoWidth:!0,dom:"ti",serverSide:!0,deferRender:!0,ordering:!0,searching:!0,aaSorting:[],aoSearchCols:n,scrollY:"60vh",scrollX:"100%",retrieve:!0,stateSave:!0,stateSaveCallback:function(t,s){sessionStorage.setItem("DataTables_"+e+"-"+a+"-"+o,JSON.stringify(s))},stateLoadCallback:function(t){return JSON.parse(sessionStorage.getItem("DataTables_"+e+"-"+a+"-"+o))},columnDefs:[{searchable:!1,orderable:!1,width:"1%",className:"select-checkbox",targets:0}],select:{style:"multi",selector:"td:first-child"},buttons:[{extend:"csv",fieldSeparator:";",exportOptions:{modifier:{selected:!0}}},{extend:"copy",exportOptions:{modifier:{selected:!0}}},{extend:"print",autoPrint:!0,customize:function(t){$(t.document.body).css("font-size","10pt").append('<table class="main-records table table-condensed table-bordered dataTable"><tfoot><tr><td></td><td class="pull-right">'+$("#summable").text()+"</td><td></td></tr></tfoot></table>"),$(t.document.body).find("table").addClass("compact").css("font-size","inherit"),$(t.document.body).find("td:first-child").addClass("hide"),$(t.document.body).find("th:first-child").addClass("hide")},exportOptions:{modifier:{selected:!0}}},{extend:"excel",exportOptions:{modifier:{selected:!0},format:{body:function(t,e,a,o){return t=$("<p>"+t+"</p>").text(),data_edit=t.replace(".",""),data_edit=data_edit.replace(",","."),data_edit.match(/^[0-9\.]+$/)?data_edit:t}}}},{extend:"pdf",exportOptions:{modifier:{selected:!0}}}],scroller:{loadingIndicator:!0,displayBuffer:globals.dataload_page_buffer},ajax:{url:"ajax_dataload.php?id_module="+e+"&id_plugin="+a+"&id_parent="+o,type:"GET",dataSrc:function(t){return r=t,t.data}},initComplete:function(e){var a=this.api(),o=getTableSearch();a.columns(".search").every(function(){var e,a=this,s=$(a.header()),n=s.attr("id").replace("th_",""),i=o["search_"+n]?o["search_"+n]:"";$('<br><input type="text" style="width:100%" class="form-control'+(i?" input-searching":"")+'" placeholder="'+globals.translations.filter+'..." value="'+i+'"><i class="deleteicon fa fa-times fa-2x'+(i?"":" hide")+'"></i>').appendTo(a.header()).on("keyup",function(o){function s(t,e,o){searchTable(t,e,o),a.search(o).draw()}clearInterval(e),9!=o.which&&($(this).val()?(void 0!=$(this).parent().data("slow")&&0==$("#slow").length&&$("#"+t.attr("id")+"_info").parent().append('<span class="text-danger" id="slow"><i class="fa fa-refresh fa-spin"></i> '+globals.translations.long+"</span>"),$(this).addClass("input-searching"),$(this).next(".deleteicon").removeClass("hide")):(void 0!=$(this).parent().data("slow")&&$("#slow").remove(),$(this).removeClass("input-searching"),$(this).next(".deleteicon").addClass("hide")));var n=t.data("idmodule"),i=$(this).parent().attr("id").replace("th_",""),r=$(this).val();13==o.keyCode||""==$(this).val()?s(n,i,r):e=window.setTimeout(s,l,n,i,r)})}),$("thead input, .search").on("keypress",function(t){stopTableSorting(t)}),$("thead input, .deleteicon").click(function(t){stopTableSorting(t)}),$(".deleteicon").on("click",function(t){resetTableSearch($(this).parent().attr("id").replace("th_","")),-1==a.page.len()&&a.page.len($(id).data("page-length"))})},rowCallback:function(e,a,o){$(a[0]).data("id")&&-1!==$.inArray($(a[0]).data("id"),t.data("selected").split(";"))&&d.row(o).select()},drawCallback:function(e){var a=new $.fn.dataTable.Api(e);$(".dataTables_sizing .deleteicon").addClass("hide"),$("[data-background]").each(function(){$(this).parent().css("background",$(this).data("background"))}),$("[data-color]").each(function(){$(this).parent().css("color",$(this).data("color"))}),$("[data-link]").each(function(){var t=$(this);$(this).parent().not(".bound").addClass("bound").click(function(e){"dialog"==t.data("type")?launch_modal(globals.translations.details,t.data("link")):openLink(e,t.data("link"))}),$(this).parent().addClass("clickable")});var o=$(document).find("[data-target="+t.attr("id")+"]");a.rows({selected:!0}).count()>0?o.find(".table-btn").removeClass("disabled").attr("disabled",!1):o.find(".table-btn").addClass("disabled").attr("disabled",!0),-1==a.page.len()&&(a.rows({search:"applied"}).select(),this.fnSettings().fnRecordsDisplay()==a.rows({selected:!0}).count()&&$("#main_loading").fadeOut())},footerCallback:function(t,e,a,o,s){var n=-1;this.api().columns().every(function(){void 0!=r.summable[n]&&($(this.footer()).addClass("text-right"),$(this.footer()).attr("id","summable"),$(this.footer()).html(r.summable[n])),n++})}});d.on("select deselect",function(e,a,o,s){if("row"===o){var n=t.data("selected").split(";");n=n.filter(function(t,e,a){return""!=t&&a.indexOf(t)===e});d.rows(s).data().each(function(t){var a=$(t[0]).data("id");if(a)if("select"==e.type)n.push(a);else{var o=n.indexOf(""+a);o>-1&&delete n[o]}}),n=n.filter(function(t,e,a){return""!=t&&a.indexOf(t)===e}),t.data("selected",n.join(";"));var i=$(document).find("[data-target="+t.attr("id")+"]");n.length>0?(i.find(".bulk-container").removeClass("disabled"),i.find(".bulk-container").attr("disabled",!1)):(i.find(".bulk-container").addClass("disabled"),i.find(".bulk-container").attr("disabled",!0)),d.rows({selected:!0}).count()>0?i.find(".table-btn").removeClass("disabled").attr("disabled",!1):i.find(".table-btn").addClass("disabled").attr("disabled",!0)}}),d.on("processing.dt",function(e,a,o){if(o)$("#mini-loader").show();else{$("#mini-loader").hide();var s=t.data("selected").split(";");d.rows().every(function(t,e,a){var o=$.parseHTML(this.data()[0])[0],n=$(o).data("id");for(i=0;i<s.length;i++){s[i]==n&&d.row(":eq("+t+")",{page:"current"}).select()}})}})}})}function stopTableSorting(t){if(!t)var t=window.event;t.cancelBubble=!0,t.stopPropagation&&t.stopPropagation()}function resetTableSearch(t){null==t?$("[id^=th_] input").val("").trigger("keyup"):$("[id^=th_"+t+"] input").val("").trigger("keyup")}function reset(t){return resetTableSearch(t)}function searchFieldName(t){return t.replace(" ","-").replace(".","")}function searchTable(t,e,a){session_set("module_"+t+",search_"+searchFieldName(e),a,0)}function getTableSearch(){var t=getUrlVars();return globals.search.forEach(function(e,a,o){void 0==t[o[a]]&&(t[o[a]]=o[e])}),t}function start_datepickers(){var t={time:"fa fa-clock-o",date:"fa fa-calendar",up:"fa fa-chevron-up",down:"fa fa-chevron-down",previous:"fa fa-chevron-left",next:"fa fa-chevron-right",today:"fa fa-street-view",clear:"fa fa-trash",close:"fa fa-times"},e=dateFormatMoment(globals.date_format),a=dateFormatMoment(globals.timestamp_format),o=dateFormatMoment(globals.time_format);$(".timestamp-picker").each(function(){$this=$(this),$this.datetimepicker({format:a,locale:globals.locale,icons:t,collapse:!1,sideBySide:!0,useCurrent:!1,stepping:5,widgetPositioning:{horizontal:"left",vertical:"auto"},minDate:!!moment($this.attr("min-date")).isValid()&&$this.attr("min-date"),maxDate:!!moment($this.attr("max-date")).isValid()&&$this.attr("max-date")})}),$(".timestamp-picker").each(function(){$this=$(this),$this.on("dp.show",function(t){$("#tecnici > div").removeClass("table-responsive")}),$this.on("dp.hide",function(t){$("#tecnici > div").addClass("table-responsive")})}),$(".datepicker").each(function(){$this=$(this),$this.datetimepicker({format:e,locale:globals.locale,icons:t,useCurrent:!1,minDate:!!moment($this.attr("min-date")).isValid()&&$this.attr("min-date"),maxDate:!!moment($this.attr("max-date")).isValid()&&$this.attr("max-date")})}),$(".timepicker").each(function(){$this=$(this),$this.datetimepicker({format:o,locale:globals.locale,icons:t,useCurrent:!1,stepping:5,minDate:!!moment($this.attr("min-date")).isValid()&&$this.attr("min-date"),maxDate:!!moment($this.attr("max-date")).isValid()&&$this.attr("max-date")})})}function start_complete_calendar(t,e){var a={};a[globals.translations.today]=[moment(),moment()],a[globals.translations.firstThreemester]=[moment("01","MM"),moment("03","MM").endOf("month")],a[globals.translations.secondThreemester]=[moment("04","MM"),moment("06","MM").endOf("month")],a[globals.translations.thirdThreemester]=[moment("07","MM"),moment("09","MM").endOf("month")],a[globals.translations.fourthThreemester]=[moment("10","MM"),moment("12","MM").endOf("month")],a[globals.translations.firstSemester]=[moment("01","MM"),moment("06","MM").endOf("month")],a[globals.translations.secondSemester]=[moment("06","MM"),moment("12","MM").endOf("month")],a[globals.translations.thisMonth]=[moment().startOf("month"),moment().endOf("month")],a[globals.translations.lastMonth]=[moment().subtract(1,"month").startOf("month"),moment().subtract(1,"month").endOf("month")],a[globals.translations.thisYear]=[moment().startOf("year"),moment().endOf("year")],a[globals.translations.lastYear]=[moment().subtract(1,"year").startOf("year"),moment().subtract(1,"year").endOf("year")];var o=dateFormatMoment(globals.date_format);$(t).daterangepicker({locale:{format:o,customRangeLabel:globals.translations.custom,applyLabel:globals.translations.apply,cancelLabel:globals.translations.cancel,fromLabel:globals.translations.from,toLabel:globals.translations.to},ranges:a,startDate:globals.start_date_formatted,endDate:globals.end_date_formatted,applyClass:"btn btn-success btn-sm",cancelClass:"btn btn-danger btn-sm",linkedCalendars:!1},e)}function launch_modal(t,e,a){openModal(t,e)}function openModal(t,e){$.fn.modal.Constructor.prototype.enforceFocus=function(){};do{id="#bs-popup-"+Math.floor(100*Math.random())}while(0!=$(id).length);0==$(id).length&&$("#modals").append('<div class="modal fade" id="'+id.replace("#","")+'" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="true"></div>'),$(id).on("hidden.bs.modal",function(){$(".modal-backdrop").length<1&&($(this).html(""),$(this).data("modal",null))});var a='<div class="modal-dialog modal-lg">    <div class="modal-content">        <div class="modal-header bg-light-blue">            <button type="button" class="close" data-dismiss="modal">                <span aria-hidden="true">&times;</span><span class="sr-only">'+globals.translations.close+'</span>            </button>            <h4 class="modal-title">                <i class="fa fa-pencil"></i> '+t+'            </h4>        </div>        <div class="modal-body">|data|</div>    </div></div>';if("#"==e.substr(0,1)){var o=$(e).html();$(id).html(a.replace("|data|",o)),$(id).modal("show")}else $.get(e,function(t,e){"success"==e&&($(id).html(a.replace("|data|",t)),$(id).modal("show"))})}function openLink(t,e){t.ctrlKey?window.open(e):location.href=e}function scrollToOffset(t){$("html,body").animate({scrollTop:t},"slow")}function getUrlVars(){var t=window.location.search.substring(1);return t?JSON.parse('{"'+t.replace(/&/g,'","').replace(/=/g,'":"')+'"}',function(t,e){return""===t?e:decodeURIComponent(e)}):{}}function clock(){$("#datetime").html(moment().formatPHP(globals.timestamp_format)),setTimeout("clock()",1e3)}function session_set_array(t,e,a){return void 0==a&&(a=1),$.get(globals.rootdir+"/ajax.php?op=session_set_array&session="+t+"&value="+e+"&inversed="+a)}function session_set(t,e,a,o){return void 0==a&&(a=1),void 0==o&&(o=0),$.get(globals.rootdir+"/ajax.php?op=session_set&session="+t+"&value="+e+"&clear="+a,function(t,e){1==o&&location.reload()})}function session_keep_alive(){$.get(globals.rootdir+"/core.php")}function update_counter(t,e){new_text=$("#"+t).html(),pattern=/([^0-9]+)([0-9]+)\/([0-9]+)([^0-9]+)/,new_text=new_text.replace(pattern,"$1"+e+"/$3$4"),matches=pattern.exec(new_text),total=matches[3],$("#"+t).html(new_text),e==total?$("#"+t).removeClass("btn-warning").removeClass("btn-danger").addClass("btn-success"):0==e?$("#"+t).removeClass("btn-warning").removeClass("btn-success").addClass("btn-danger"):$("#"+t).removeClass("btn-success").removeClass("btn-danger").addClass("btn-warning")}function setContrast(t){var e=[],a=String(t);e[0]=a.substr(1,2),e[1]=a.substr(2,2),e[2]=a.substr(5,2);var o=parseInt(e[0],16),s=parseInt(e[1],16),n=parseInt(e[2],16),i=.2126*Math.pow(o/255,2.2)+.7152*Math.pow(s/255,2.2)+.0722*Math.pow(n/255,2.2),r=.2126*Math.pow(1,2.2)+.7152*Math.pow(1,2.2)+.0722*Math.pow(1,2.2);if(i>r)var l=(i+.05)/(r+.05);else var l=(r+.05)/(i+.05);return l>=9?"#ffffff":"#000000"}function message(t){data=$.extend({},$(t).data());var e=globals.translations.deleteTitle;void 0!=data.title&&(e=data.title);var a=globals.translations.deleteMessage;void 0!=data.msg&&(a=data.msg);var o=globals.translations.delete;void 0!=data.button&&(o=data.button);var s="btn btn-lg btn-danger";void 0!=data.class&&(s=data.class),swal({title:e,html:'<div id="swal-form" data-parsley-validate>'+a+"</div>",type:"warning",showCancelButton:!0,confirmButtonText:o,confirmButtonClass:s,onOpen:function(){start_superselect(),start_inputmask()},preConfirm:function(){if($form=$("#swal-form"),$form.find(":input").each(function(){data[$(this).attr("name")]=$(this).val()}),$form.parsley().validate())return new Promise(function(t){t()});$(".swal2-buttonswrapper button").each(function(){$(this).prop("disabled",!1)})}}).then(function(){void 0==data.op&&(data.op="delete");var t=window.location.href.split("#")[0];void 0!=data.href&&(t=data.href,delete data.href);var e=window.location.href.split("#")[1];e&&(data.hash=e),method="post",void 0!=data.method&&("post"!=data.method&&"get"!=data.method||(method=data.method),delete data.method),blank=void 0!=data.blank&&data.blank,delete data.blank,data.callback?$.ajax({type:method,crossDomain:!0,url:t,data:data,beforeSend:function(t){var e=window[data.before];"function"==typeof e&&e(t)},success:function(t){var e=window[data.callback];"function"==typeof e&&e(t)},error:function(t,e,a){swal({title:globals.translations.errorTitle,html:globals.translations.errorMessage,type:"error"})}}):redirect(t,data,method,blank)},function(t){})}function redirect(t,e,a,o){if(a=a||"get",o=o||!1,"post"==a){var s='<form action="'+t+window.location.hash+'" method="post"'+(o?' target="_blank"':"")+">";for(var n in e)s+='<input type="hidden" name="'+n+'" value="'+e[n]+'"/>';s+="</form>";var i=$(s);$("body").append(i),i.submit()}else{var r=[];for(var n in e)r.push(n+"="+e[n]);var l=t+(-1!==t.indexOf("?")?"&":"?")+r.join("&")+window.location.hash;o?window.open(l):location.href=l}}function setCookie(t,e,a){var o=new Date;o.setTime(o.getTime()+24*a*60*60*1e3);var s="expires="+o.toUTCString();document.cookie=t+"="+e+";"+s+";path=/"}function getCookie(t){for(var e=t+"=",a=decodeURIComponent(document.cookie),o=a.split(";"),s=0;s<o.length;s++){for(var n=o[s];" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(e))return n.substring(e.length,n.length)}return""}function buttonLoading(t){var e=$(t),a=[e.html(),e.attr("class")];return e.html('<i class="fa fa-spinner fa-pulse fa-fw"></i> Attendere...'),e.addClass("btn-warning"),e.prop("disabled",!0),a}function buttonRestore(t,e){var a=$(t);a.html(e[0]),a.attr("class",""),a.addClass(e[1]),a.prop("disabled",!1)}function submitAjax(t,e,a,o){var s=$(t).parsley().validate();return e||(e={}),s&&($("#main_loading").show(),content_was_modified=!1,e.id_module=e.id_module?e.id_module:globals.id_module,e.id_record=e.id_record?e.id_record:globals.id_record,e.id_plugin=e.id_plugin?e.id_plugin:globals.id_plugin,e.ajax=1,prepareForm(t),$(t).ajaxSubmit({url:globals.rootdir+"/actions.php",data:e,type:"post",success:function(t){t=t.trim(),t&&(response=JSON.parse(t),a&&a(response)),$("#main_loading").fadeOut(),renderMessages()},error:function(t){$("#main_loading").fadeOut(),toastr.error(t),o&&o(t)}})),s}function prepareForm(t){$(t).find("input:disabled, select:disabled").prop("disabled",!1);var e=window.location.hash;if(e){var a=$("<input/>",{type:"hidden",name:"hash",value:e});$(t).append(a)}}function renderMessages(){$.ajax({url:globals.rootdir+"/ajax.php",type:"get",data:{op:"flash"},success:function(t){messages=JSON.parse(t),info=messages.info?messages.info:[],info.forEach(function(t){t&&toastr.success(t)}),warning=messages.warning?messages.warning:[],warning.forEach(function(t){t&&toastr.warning(t)}),error=messages.error?messages.error:[],error.forEach(function(t){t&&toastr.error(t)})}})}function removeHash(){history.replaceState(null,null," ")}function replaceAll(t,e,a){return t.replace(new RegExp(e,"g"),a)}function cleanup_inputs(){$(".superselect, .superselectajax").select2().select2("destroy")}function restart_inputs(){start_datepickers(),start_inputmask(),start_superselect(),autosize($(".autosize"))}function alertPush(){if($(window).width()>1023){var t=0;$(".alert-success.push").each(function(){t++,tops=60*t+95,$(this).css({position:"fixed","z-index":3,right:"10px",top:-100}).delay(1e3).animate({top:tops}).delay(3e3).animate({top:-100})})}$(".alert-success.push").on("mouseover",function(){$(this).stop().animate({top:-100,opacity:0})})}function startHooks(){$.ajax({url:globals.rootdir+"/ajax.php",type:"get",data:{op:"hooks"},success:function(t){hooks=JSON.parse(t),$("#hooks-header").text(globals.translations.hooksExecuting),$("#hooks-number").text(hooks.length),0==hooks.length&&($("#hooks-loading").hide(),$("#hooks-number").text(0),$("#hooks-header").text(globals.translations.hookNone)),hooks.forEach(function(t,e){renderHook(t,{show:!0,message:globals.translations.hookExecuting.replace("_NAME_",t.name)}),startHook(t,!0)})}})}function startHook(t,e){$.ajax({url:globals.rootdir+"/ajax.php",type:"get",data:{op:"hook-lock",id:t.id},success:function(a){var o=JSON.parse(a);if(e&&(hookCount("#hooks-counter"),updateHook(t)),o)executeHook(t,o);else{setTimeout(function(){startHook(t)},1e4)}}})}function executeHook(t,e){$.ajax({url:globals.rootdir+"/ajax.php",type:"get",data:{op:"hook-execute",id:t.id,token:e},success:function(e){var a=JSON.parse(e);updateHook(t);var o;a.execute?startHook(t):(o=30,setTimeout(function(){startHook(t)},1e3*o))}})}function updateHook(t){$.ajax({url:globals.rootdir+"/ajax.php",type:"get",data:{op:"hook-response",id:t.id},success:function(e){var a=JSON.parse(e);renderHook(t,a);var o=$("#hooks-counter").text(),s=$("#hooks > li").length;if(0==s?($("#hooks-notified").html('<i class="fa fa-check" aria-hidden="true"></i>'),$("#hooks-label").removeClass(),$("#hooks-label").addClass("label").addClass("label-success")):($("#hooks-notified").text(s),$("#hooks-label").removeClass(),$("#hooks-label").addClass("label").addClass("label-danger")),o==$("#hooks-number").text()){$("#hooks-loading").hide();var n;n=s>1?globals.translations.hookMultiple.replace("_NUM_",s):1==s?globals.translations.hookSingle:globals.translations.hookNone,$("#hooks-header").text(n)}}})}function hookCount(t,e){e=e||1;var a=$(t),o=parseInt(a.text());return o=isNaN(o)?0:o,o+=e,a.text(o),o}function renderHook(t,e){if(0!=e.length){var a="hook-"+t.id,o=$("#"+a);if(0==o.length&&($("#hooks").append('<li class="hook-element" id="'+a+'"></li>'),o=$("#"+a)),!e.show)return void o.remove();var s='<a href="'+(e.link?e.link:"#")+'"><i class="'+e.icon+'"></i><span class="small"> '+e.message+"</span>";if(e.progress){var n=e.progress.current,i=e.progress.total,r=n/i*100;r=isNaN(r)?100:r,r=Math.round(100*r)/100,s+='<div class="progress" style="margin-bottom: 0px;"><div class="progress-bar" role="progressbar" aria-valuenow="'+r+'" aria-valuemin="0" aria-valuemax="100" style="width:'+r+'%">'+r+"% ("+n+"/"+i+")</div></div>"}s+="</a>",o.html(s)}}function init(){$(".box").boxWidget(),$("[data-href]").not(".ask, .bound").click(function(){launch_modal($(this).data("title"),$(this).data("href"),1)}),$("[data-href]").not(".ask, .bound").addClass("bound clickable"),$(".tip").not(".tooltipstered").each(function(){$this=$(this),$this.tooltipster({animation:"grow",contentAsHTML:!0,hideOnClick:!0,onlyOne:!0,maxWidth:350,touchDevices:!0,trigger:"hover",position:$this.data("position")?$this.data("position"):"top"})}),$("form").length&&$("form").not(".no-check").parsley(),$("form").on("submit",function(t){return!(!$(this).parsley().validate()||void 0!=t.result&&!t.result)&&($(this).submit(function(){return!1}),$(this).find("[type=submit]").prop("disabled",!0).addClass("disabled"),prepareForm(this),!0)}),window.Parsley.on("field:success",function(){this.$element.removeClass("parsley-success")}),restart_inputs()}function start_inputmask(t){void 0==t?t="":t+=" ";var e=dateFormatMoment(globals.date_format).toLowerCase();$(t+".date-mask").not(".bound").inputmask(e,{placeholder:e}).addClass("bound"),$(t+".email-mask").not(".bound").inputmask("Regex",{regex:"^[a-zA-Z0-9_!#$%&'*+/=?`{|}~^-]+(?:\\.[a-zA-Z0-9_!#$%&'*+/=?`{|}~^-]+)*@[a-zA-Z0-9-]+(?:\\.[a-zA-Z0-9-]+)*$"}).addClass("bound"),$(t+".alphanumeric-mask").not(".bound").inputmask("Regex",{regex:"[A-Za-z0-9#_|/\\-.]*"}).addClass("bound"),$(t+".math-mask").not(".bound").inputmask("Regex",{regex:"[0-9,.+-]*"}).addClass("bound"),globals.is_mobile?$(t+".inputmask-decimal, "+t+".date-mask, "+t+".timestamp-mask").each(function(){$(this).attr("type","tel")}).addClass("bound"):$(t+".inputmask-decimal").not(".bound").each(function(){var t=$(this),e=t.attr("min-value");"undefined"==e&&(e=!1);var a=t.attr("max-value");"undefined"==a&&(a=!1),t.inputmask("decimal",{min:e||void 0,allowMinus:!e||e<0,max:a||void 0,allowPlus:!a||a<0,digits:t.attr("decimals")?t.attr("decimals"):globals.cifre_decimali,digitsOptional:!0,enforceDigitsOnBlur:!0,rightAlign:!0,autoGroup:!0,radixPoint:globals.decimals,groupSeparator:globals.thousands,onUnMask:function(t,e){return t.toEnglish()}}),t.on("keyup",function(){e&&$(this).val().toEnglish()<e&&$(this).val(e)})}).addClass("bound")}function dateFormatMoment(t){var e={d:"DD",D:"ddd",j:"D",l:"dddd",N:"E",S:function(){return"["+moment().format("Do").replace(/\d*/g,"")+"]"},w:"d",z:function(){return moment().format("DDD")-1},W:"W",F:"MMMM",m:"MM",M:"MMM",n:"M",t:function(){return moment().daysInMonth()},L:function(){return moment().isLeapYear()?1:0},o:"GGGG",Y:"YYYY",y:"YY",a:"a",A:"A",B:function(){var t=moment().clone().utc(),e=(t.hours()+1)%24+t.minutes()/60+t.seconds()/3600;return Math.floor(1e3*e/24)},g:"h",G:"H",h:"hh",H:"HH",i:"mm",s:"ss",u:"[u]",e:"[e]",I:function(){return moment().isDST()?1:0},O:"ZZ",P:"Z",T:"[T]",Z:function(){return 36*parseInt(moment().format("ZZ"),10)},c:"YYYY-MM-DD[T]HH:mm:ssZ",r:"ddd, DD MMM YYYY HH:mm:ss ZZ",U:"X"},a=/[dDjlNSwzWFmMntLoYyaABgGhHisueIOPTZcrU]/g;return t.replace(a,function(t){return"function"==typeof e[t]?e[t].call(that):e[t]})}function start_superselect(){$(".superselect").each(function(){$this=$(this),$(this).select2({theme:"bootstrap",language:"it",width:"100%",maximumSelectionLength:$this.data("maximum")?$this.data("maximum"):-1,minimumResultsForSearch:$this.hasClass("no-search")?-1:0,allowClear:!$this.hasClass("no-search"),templateResult:function(t,e){var a;return t._bgcolor_?a=t._bgcolor_:$(t.element).attr("_bgcolor_")?a=$(t.element).attr("_bgcolor_"):$(t.element).data("_bgcolor_")&&(a=$(t.element).data("_bgcolor_")),a&&($(e).css("background-color",a),$(e).css("color",setContrast(a))),t.text},escapeMarkup:function(t){return t}})}),$(".superselectajax").each(function(){$this=$(this),$(this).select2({theme:"bootstrap",language:"it",maximumSelectionLength:$this.data("maximum")?$this.data("maximum"):-1,minimumInputLength:$this.data("heavy")?3:0,allowClear:!0,escapeMarkup:function(t){return t},templateResult:function(t,e){var a;return t._bgcolor_?a=t._bgcolor_:$(t.element).attr("_bgcolor_")?a=$(t.element).attr("_bgcolor_"):$(t.element).data("_bgcolor_")&&(a=$(t.element).data("_bgcolor_")),a&&!$("head").find("#"+t._resultId+"_style").length&&($(e).css("background-color",a),$(e).css("color",setContrast(a))),t.text},ajax:{url:globals.rootdir+"/ajax_select.php?op="+$this.data("source"),dataType:"json",delay:250,data:function(t){return{search:t.term,page:t.page||0,length:t.length||100}},processResults:function(t,e){return e.page=e.page||0,e.length=e.length||100,{results:t.results,pagination:{more:(e.page+1)*e.length<t.recordsFiltered}}},cache:!1},width:"100%"})})}!function(t){moment.fn.formatPHP=function(t){return this.format(dateFormatMoment(t))}}(moment),Number.prototype.formatMoney=function(t,e,a){var o=this,t=isNaN(t=Math.abs(t))?2:t,e=void 0==e?".":e,a=void 0==a?",":a,s=o<0?"-":"",n=parseInt(o=Math.abs(+o||0).toFixed(t))+"",i=(i=n.length)>3?i%3:0;return s+(i?n.substr(0,i)+a:"")+n.substr(i).replace(/(\d{3})(?=\d)/g,"$1"+a)+(t?e+Math.abs(o-n).toFixed(t).slice(2):"")},String.prototype.toEnglish=function(){return numeral(this.toString()).value()},Number.prototype.toLocale=function(){return numeral(this).format()},jQuery.fn.scrollTo=function(t,e){return $(this).animate({scrollTop:$(this).scrollTop()-$(this).offset().top+$(t).offset().top},void 0==e?1e3:e),this},jQuery.fn.selectClear=function(){return this.val([]).trigger("change"),this},jQuery.fn.selectReset=function(t){return this.selectClear(),this.empty(),void 0!=t&&(this.next().find(".select2-selection__placeholder").text(t),this.next().find("input.select2-search__field").attr("placeholder",t)),this},jQuery.fn.selectSetNew=function(t,e,a){return this.selectReset(),this.selectAdd([{value:t,text:e,data:a}]),this.selectSet(t),this},jQuery.fn.selectSet=function(t){return this.val(t).trigger("change"),this},jQuery.fn.selectAdd=function(t){return $this=this,t.forEach(function(t){t.data&&Object.keys(t.data).forEach(function(e){t["data-"+e]=t.data[e]}),delete t.data;var e=$("<option/>",t);$this.append(e)}),this},jQuery.fn.selectData=function(){var t=$(this[0]);return $select_obj=t.select2("data"),void 0==$select_obj[0]?void 0:0==$select_obj[0].selected?$select_obj[0]:$select_obj[0].element.dataset};