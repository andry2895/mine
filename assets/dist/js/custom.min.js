$(window).on("beforeunload",function(){$("#main_loading").show()}),$(window).on("load",function(){$("#main_loading").fadeOut()}),$(document).on("hidden.bs.modal",".modal",function(){$(this).remove(),$(".modal:visible").length&&$(document.body).addClass("modal-open")}),$(document).ready(function(){toastr.options={closeButton:!0,debug:!1,newestOnTop:!1,progressBar:!0,positionClass:"toast-top-right",preventDuplicates:!0,onclick:null,showDuration:"300",hideDuration:"1000",timeOut:"12000",extendedTimeOut:"8000",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},numeral.register("locale","current",{delimiters:{thousands:globals.thousands,decimal:globals.decimals},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},currency:{symbol:"â‚¬"}}),numeral.locale("current"),numeral.defaultFormat("0,0."+"0".repeat(globals.cifre_decimali)),start_datatables(),start_complete_calendar("#daterange",function(t,e){$.get(globals.rootdir+"/core.php?period_start="+t.format("YYYY-MM-DD")+"&period_end="+e.format("YYYY-MM-DD"),function(t){location.reload()})}),$(document).on("click",".ask",function(){message(this)}),setTimeout(function(){$("form").on("submit",function(){$("input").trigger("blur")})},1e3)}),$(document).ready(function(){$(".btn-csv").click(function(t){$(document).find("#"+$(this).closest("[data-target]").data("target")).DataTable().buttons(0).trigger()}),$(".btn-excel").click(function(t){$(document).find("#"+$(this).closest("[data-target]").data("target")).DataTable().buttons(3).trigger()}),$(".btn-pdf").click(function(t){$(document).find("#"+$(this).closest("[data-target]").data("target")).DataTable().buttons(4).trigger()}),$(".btn-copy").click(function(t){$(document).find("#"+$(this).closest("[data-target]").data("target")).DataTable().buttons(1).trigger()}),$(".btn-print").click(function(t){$(document).find("#"+$(this).closest("[data-target]").data("target")).DataTable().buttons(2).trigger()}),$(".btn-select-all").click(function(){var t=$(document).find("#"+$(this).parent().parent().parent().data("target")),e=t.DataTable();$("#main_loading").show(),e.clear().draw(),$(t).data("page-length",e.page.len()),e.page.len(-1).draw()}),$(".btn-select-none").click(function(){var t=$(document).find("#"+$(this).parent().parent().parent().data("target")),e=t.DataTable();e.rows().deselect(),e.page.len($(t).data("page-length"))}),$(".bulk-action").click(function(){var t=$(document).find("#"+$(this).parent().parent().parent().parent().data("target"));if(t.data("selected")){if($(this).attr("data-id_records",t.data("selected")),$(this).data("id_records",t.data("selected")),"modal"==$(this).data("type")){var e=JSON.parse(JSON.stringify($(this).data())),a=e.url;delete e.url,delete e.title,delete e.op,delete e.backto,delete e.blank;var o=[];for(var i in e)o.push(i+"="+e[i]);var n=a+(-1!==a.indexOf("?")?"&":"?")+o.join("&");launch_modal($(this).data("title"),n)}else message(this);$(this).attr("data-id_records",""),$(this).data("id_records","")}else swal(globals.translations.waiting,globals.translations.waiting_msg,"error")})}),$(document).ready(function(){$(".nav-tabs").tabs();var t=location.hash?location.hash:getUrlVars().hash;t&&"#tab_0"!=t?$('ul.nav-tabs a[href="'+t+'"]').tab("show").trigger("shown.bs.tab"):removeHash(),$(window).bind("beforeunload",function(){"#tab_0"==location.hash&&removeHash()}),globals.is_mobile||($(window).on("scroll",function(){void 0!=sessionStorage&&sessionStorage.setItem("scrollTop_"+globals.id_module+"_"+globals.id_record,$(document).scrollTop())}),void 0!=sessionStorage["scrollTop_"+globals.id_module+"_"+globals.id_record]&&setTimeout(function(){scrollToOffset(sessionStorage["scrollTop_"+globals.id_module+"_"+globals.id_record])},1)),$(".nav-tabs a").click(function(t){$(this).tab("show");var e=$("body").scrollTop()||$("html").scrollTop();window.location.hash=this.hash,$("html,body").scrollTop(e)}),$('a[data-toggle="tab"]').on("shown.bs.tab",function(t){$($.fn.dataTable.tables(!0)).DataTable().columns.adjust(),$($.fn.dataTable.tables(!0)).DataTable().scroller.measure()})}),$(document).ready(function(){for($(".sidebar-menu").tree({followLink:!0}),$(".sidebar-menu > li.treeview i.fa-angle-left").click(function(t){t.preventDefault(),$(this).find("ul").stop().slideDown()}),$(".sidebar-menu > li.treeview i.fa-angle-down").click(function(t){t.preventDefault(),$(this).find("ul").stop().slideUp()}),$menulist=$(".treeview-menu > li.active"),i=0;i<$menulist.length;i++)$list=$($menulist[i]),$list.parent().show().parent().addClass("active"),$list.parent().parent().find("i.fa-angle-left").removeClass("fa-angle-left").addClass("fa-angle-down");$(".sidebar-menu").sortable({cursor:"move",stop:function(t,e){var a=$(this).sortable("toArray").toString();$.post(globals.rootdir+"/actions.php?id_module="+globals.order_manager_id,{op:"sort_modules",ids:a})}}),globals.is_mobile&&$(".sidebar-menu").sortable("disable"),$(".sidebar-toggle").click(function(){setTimeout(function(){window.dispatchEvent(new Event("resize"))},350)})}),$(document).ready(function(){var t=$("<div />");t.html('<i class="fa fa-chevron-up"></i>'),t.css({position:"fixed",bottom:"20px",right:"25px",width:"40px",height:"40px",color:"#eee","font-size":"","line-height":"40px","text-align":"center","background-color":"rgba(255, 78, 0)","box-shadow":"0 0 10px rgba(0, 0, 0, 0.05)",cursor:"pointer","z-index":"99999",opacity:".7",display:"none"}),t.on("mouseenter",function(){$(this).css("opacity","1")}),t.on("mouseout",function(){$(this).css("opacity",".7")}),$(".wrapper").append(t),$(window).scroll(function(){$(window).scrollTop()>=150?$(t).is(":visible")||$(t).fadeIn(500):$(t).fadeOut(500)}),$(t).click(function(){$("html, body").animate({scrollTop:0},500)})}),$(document).ready(function(){$("#supersearch").keyup(function(){$(document).ajaxStop(),""==$(this).val()?$(this).removeClass("wait"):$(this).addClass("wait")}),$.widget("custom.supersearch",$.ui.autocomplete,{_create:function(){this._super(),this.widget().menu("option","items","> :not(.ui-autocomplete-category)")},_renderMenu:function(t,e){if(void 0==e[0].value)$("#supersearch").removeClass("wait"),t.html("");else{var a=this,o="";t.addClass("ui-autocomplete-scrollable"),t.css("z-index","999"),$.each(e,function(e,i){i.category!=o&&(t.append("<li class='ui-autocomplete-category'>"+i.category+"</li>"),o=i.category),a._renderItemData(t,i)})}},_renderItem:function(t,e){return $("<li>").append("<a href='"+e.link+"' title='Clicca per aprire'><b>"+e.value+"</b><br/>"+e.label+"</a>").appendTo(t)}});$("#supersearch").supersearch({minLength:3,select:function(t,e){location.href=e.item.link},source:function(t,e){$.ajax({url:globals.rootdir+"/ajax_search.php",dataType:"json",data:{term:t.term},complete:function(t){$("#supersearch").removeClass("wait")},success:function(t){e(null==t?$.map(["a"],function(t){return!1}):$.map(t,function(t){return labels=t.labels.toString(),labels=labels.replace("<br/>,","<br/>"),{label:labels,category:t.category,link:t.link,value:t.title}}))}})}})}),$(document).ready(function(){$("#widget-top, #widget-right").sortable({items:"li",cursor:"move",dropOnEmpty:!0,connectWith:".widget",scroll:!0,helper:"clone",start:function(t,e){src_list=$(this).attr("id").replace("widget-",""),$(".widget").addClass("bordered").sortable("refreshPositions")},stop:function(t,e){$(".widget").removeClass("bordered"),dst_list=e.item.parent().attr("id").replace("widget-","");var a=$(this).sortable("toArray").toString();$.post(globals.rootdir+"/actions.php?id_module="+globals.order_manager_id,{op:"sort_widgets",location:dst_list,ids:a,id_module_widget:globals.id_module,id_record:globals.id_record})}})});